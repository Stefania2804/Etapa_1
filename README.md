Am vrut sa imi ofer posibilitatea sa modific cat mai usor codul, deci am creat cat mai multe clase folosind doua DP -uri: Command si Strategy;
Command l-am folosit pentru comenzile de intrare (printUsers, addAccount, createCard, etc..). Am un Invoker care primeste comanda de la Client(Main) si ii apeleaza metoda execute. Am creat clase concrete pentru fiecare comanda. Acestea implementeaza interfata Command si tin loc de Receiver. 

Strategy l-am folosit pentru implementarea metodei de plata: plata online cu cardul sau plata prin transfer bancar. Cele doua clase concrete implementeaza interfata PayStrategy cu metoda generica pay();
Clasa PaymentContext are atributia de a executa plata prin metoda ceruta. Comanda payOnline vizeaza plata cu cardul. Moneda in care se face aceasta plata poate sa nu coincida cu moneda contului din care se face plata. Am implementat pentru asta in InfoBank o metoda recursiva exchange care sa rezolve atat schimburile valutare directe, cat si pe cele care trebuie sa treaca prin valute intermediare. Logica acesteia este urmatoarea: O metoda exchange care apeleaza o metoda recursiva recursiveExchange. Cea din urma se opreste si returneaza suma daca moneda de la from coincide cu cea de la to. Altfel am un vector visited pentru a evita cicluri infinite si continui sa caut conversiile directe care nu au fost vizitate. Dupa o plata cu cardul se scade suma din cont, suma convertita in moneda contului bineinteles. Daca cardul cu care s-a facut plata este de unica folosinta atunci se sterge dupa utilizare si se genereaza altul.

Comanda printTransactions este destul de complexa, deci eu am considerat clase specifice pentru ficare tranzactie. Acestea implementeaza o interfata comuna Tranzaction. Am procedat astfel pentru ca fiecare tranzactie avea campuri si afisare diferita, singurele care se pastrau comune fiind timestamp si description. La crearea instantelor toate sunt de tip Transaction pentru a putea sa le adaug intr-un Array pentru afisare. (Transaction transaction = new NewCardTransaction(..)). Am un Array de tranzactii pentru fiecare utilizator dar si pentru fiecare cont. La generarea rapoartelor tranzactiile erau specifice unui cont intr-un anumit interval de timp, iar la printTransactions tranzactiile erau specifice tuturor conturilor unui utilizator. 

Clasa abstracta JsonOutput afiseaza in format Json output-ul. Este abstracta pentru ca nu am vrut sa poata fi instantiata, vrand sa ii apelez metodele cu ajutorul numelui ei. 

In metoda action a clasei Main am extras datele de input. Am salvat si contorizat toti utilizatorii intr-un Array specific bancii. A urmat apoi sa imi creez propria clasa Exchange si sa salvez toate schmburile valutare specifice bancii intr-un Array. Comenzile le-am primit si le-am executat prin Invoker.

Clasa Account este extinsa in Classic pentru conturile clasice si in Savings pentru conturile de economii. Conturile de economii au un camp in plus fata de cele clasice, reprezentand dobanda incasata pe suma pastrata in cont. 

Cardurile sunt de doua tipuri: normale si de unica folosinta. Am extins clasa Card in NormalCard si in OneTimeCard pentru a evidentia tipurile de card si pentru a le adauga optiuni particulare noi usor in cazul in care imi voi dori acest lucru, dar si pentru a putea sa le diferentiez, avand in vedere ca se comporta diferit in contexul platilor.

Transferul bancar se face intre doua conturi. De la iban la iban sau de la iban la un alias. Se conversteste suma din moneda contului care trimite banii in moneda contului care ii primeste pentru a putea aduga suma la contul destinatar. Inainte verific daca am suficiente fonduri in cont, adica daca balanta e mai mare decat suma. In caz contrar se afiseaza eroare de Insufficient funds.

La splitPayment verific daca vreunul dintre conturi nu are founduri suficiente. Fac asta contorizand conturile care pot face plata si verificat daca acest contor este egal cu numarul de conturi implicate in plata distribuita. Daca vreunul nu are suficiente fonduri se afiseaza eroare.

Pentru rapoartele clasice am retinut pentru fiecare tranzactie timestamp-ul si le-am separat si pe conturi. In clasa JsonOutput, metoda printClassicReport verifica ca tranzactia sa fie facuta in intervalul de timp dat in input si doar in caz afirmativ o afiseaza.

La spendingsReport pe langa tranzactii am retinut pentru fiecare cont si comerciantii, beneficiarii catre care am facut plati. Pentru fiecare comerciant am retinut momentul cand s-a facut o plata catre el. Acest raport este suportat doar de un cont clasic. Pentru a calcula suma totala distribuita catre fiecare comerciant am verificat in primul rand daca tranzactia e de plata online cu cardul si daca se afla in intervalul de timp cerut. Am adaugat dupa suma la comerciant. Dupa afisarea raportului suma pe fiecare comerciant este resetata la 0.0 pentru alte cereri de rapoarte de cheltuieli.
